<!-- Start Breadcrumbs -->
<app-breadcrumbs title="خوشه اطلاعات" [breadcrumbItems]="breadCrumbItems"></app-breadcrumbs>
<!-- End Breadcrumbs -->

<div class="row">
  <div class="col-lg-12">
    <div class="card">
      <div class="card-header">
        <h4 class="card-title mb-0 flex-grow-1">لیست اطلاعات شرکت</h4>
      </div>
      <!-- end card header -->

      <div class="card-body">
        <div class="mb-lg-3 row">
          <div class="col-lg-8">
            <div class="d-flex flex-wrap gap-2 mb-3 mb-lg-0">
              <button (click)="openInsertModal()" type="button" class="btn btn-outline-primary">
                <i class="icon-content-blue las la-plus label-icon align-middle fs-20"></i>
              </button>
              <button (click)="deleteMultiple(deleteModel)" type="button" class="btn btn-outline-primary">
                <i class="icon-content-red las la-trash label-icon align-middle fs-20"></i>
              </button>
            </div>
          </div>
          <!--end col-->

          <div class="col-lg-4">
            <div style="float: left" class="d-flex flex-wrap gap-2 mb-3 mb-lg-0">
              <button type="button" class="btn btn-outline-primary">
                <i class="las la-file-excel label-icon align-middle fs-20"></i>
              </button>
              <button type="button" class="btn btn-outline-primary">
                <i class="ri-file-excel-2-line label-icon align-middle fs-20"></i>
              </button>
              <button type="button" class="btn btn-outline-primary">
                <i class="las la-file-upload label-icon align-middle fs-20"></i>
              </button>
              <button type="button" class="btn btn-outline-primary">
                <i class="las la-print label-icon align-middle fs-20"></i>
              </button>
            </div>
          </div>
          <!--end col-->
        </div>
        <!--end row-->

        <div class="search-box d-inline-block mb-2">
          <input type="text" class="form-control search" placeholder="جستجو ..." [(ngModel)]="service.searchTerm" />
          <i class="ri-search-line search-icon"></i>
        </div>

        <div class="table-responsive">
          <table class="table table-gridjs">
            <thead>
              <tr>
                <th style="width: 4px"></th>
                <th class="sort" sortable="contactUsMessage" (sort)="onSort($event)">
                  ارتباط با ما
                </th>
                <th class="sort" sortable="poweredBy" (sort)="onSort($event)">
                  حامی
                </th>
                <th class="sort" sortable="callUs" (sort)="onSort($event)">
                  تماس با ما
                </th>
                <th>لوگوی دسکتاپ</th>
                <th>لوگوی تلفن همراه</th>
                <th>لوگو فوتر</th>
                <th>پس زمینه اسلایدر</th>
                <th class="sort" sortable="isDefault" (sort)="onSort($event)">
                  پیش فرض بودن
                </th>

                <th></th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let data of gridjsList$ | async" id="lj_{{ data.id }}">
                <td>
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="checkAll" [checked]="isChecked(data.id)"
                      (change)="toggleCheckbox(data.id)" />
                  </div>
                </td>
                <td>
                  <ngb-highlight [result]="data.contactUsMessage" [term]="service.searchTerm"></ngb-highlight>
                </td>
                <td>
                  <ngb-highlight [result]="data.poweredBy" [term]="service.searchTerm"></ngb-highlight>
                </td>
                <td>
                  <ngb-highlight [result]="data.callUs" [term]="service.searchTerm"></ngb-highlight>
                </td>
                <td>
                  <img *ngIf="data.desktopLogo" [src]="data.desktopLogoSrc" alt="Desktop Logo"
                    style="max-width: 100px; max-height: 100px" />
                </td>
                <td>
                  <img *ngIf="data.mobileLogo" [src]="data.mobileLogoSrc" alt="Mobile Logo"
                    style="max-width: 100px; max-height: 100px" />
                </td>
                <td>
                  <img *ngIf="data.footerLogo" [src]="data.footerLogoSrc" alt="Footer Logo"
                    style="max-width: 100px; max-height: 100px" />
                </td>
                <td>
                  <img *ngIf="data.sliderBackGroundImage" [src]="data.sliderBackGroundImageSrc" alt="Footer Logo"
                    style="max-width: 100px; max-height: 100px" />
                </td>
                <td>
                  <strong *ngIf="data.isDefault != null && data.isDefault == true">بلی</strong>
                  <strong *ngIf="data.isDefault == null || data.isDefault == false">خیر</strong>
                </td>
                <td data-column-id="actions">
                  <a style="cursor: pointer" (click)="edit(data)" _ngcontent-agu-c388="">
                    <i _ngcontent-agu-c388="" class="las la-edit label-icon align-middle fs-22"></i>
                  </a>
                  <a style="cursor: pointer" (click)="openMoreDetailUser(data)" _ngcontent-agu-c388="">
                    <i style="color: #405189" class="las la-tasks label-icon align-middle fs-22"></i>
                  </a>
                  <!-- <a _ngcontent-agu-c388="" (click)="openDeleteConfirmationModal(data.id)"
                                        class="link-danger fs-15">
                                        <i _ngcontent-agu-c388="" class="ri-delete-bin-line"></i>
                                    </a> -->
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="row justify-content-md-between align-items-md-center">
          <div class="col-sm-12 col-md-5">
            <div class="dataTables_info mb-2" id="tickets-table_info" role="status" aria-live="polite">
              نمایش
              {{ service.totalRecords !== 0 ? service.startIndex : 0 }} تا
              {{ service.endIndex }} از {{ service.totalRecords }}
              داده
            </div>
          </div>
          <!-- Pagination -->
          <div class="col-sm-12 col-md-5">
            <div class="text-md-right float-md-end gridjs-pagination">
              <ngb-pagination [collectionSize]="(total$ | async)!" [maxSize]="10" [(page)]="service.page"
                [pageSize]="service.pageSize">
              </ngb-pagination>
            </div>
          </div>
          <!-- End Pagination -->
        </div>
      </div>
      <!-- end card-body -->
    </div>
    <!-- end card -->
  </div>
  <!-- end col -->
</div>
<!-- end row -->

<ng-template #deleteModel let-modal>
  <div class="modal-content">
    <div class="modal-header">
      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" id="btn-close"
        (click)="modal.dismiss('Cross click'); this.handleCloseFormModal()"></button>
    </div>
    <div class="modal-body">
      <div class="mt-2 text-center">
        <lord-icon src="https://cdn.lordicon.com/gsqxdxog.json" trigger="loop"
          colors="primary:#405189,secondary:#f06548" style="width: 90px; height: 90px"></lord-icon>
        <div class="mt-4 pt-2 fs-15 mx-4 mx-sm-5">
          <h4>از حذف آیتم (های) انتخاب شده مطمئن هستید؟</h4>
          <p class="text-muted mx-4 mb-0">
            تایید حذف به منزله حذف داده از پایگاه داده می باشد
          </p>
        </div>
      </div>
      <div class="d-flex gap-2 justify-content-center mt-4 mb-2">
        <button class="btn btn-link link-success fw-medium text-decoration-none" data-bs-dismiss="modal"
          (click)="modal.close('Close click')">
          <i class="ri-close-line me-1 align-middle"></i> انصراف
        </button>
        <button type="button" class="btn w-sm btn-danger" id="delete-product" (click)="deleteItems()"
          [class.btn-loading]="inProgress" [disabled]="inProgress">
          <ng-container *ngIf="!inProgress; else loadingTemplate">
            حذف کن
          </ng-container>
          <ng-template #loadingTemplate>
            <span class="visually-hidden">Loading...</span>
          </ng-template>
        </button>
      </div>
    </div>
  </div>
  <!-- /.modal-content -->
</ng-template>

<!-- Delete Modal -->
<ng-template role="document" #formModal let-modal>
  <form class="row gy-1" [formGroup]="myForm" (ngSubmit)="onSubmit()">
    <div class="modal-header">
      <h4 class="modal-title">اطلاعات شرکت</h4>
      <button type="button" class="close" aria-label="Close" (click)="modal.dismiss(); this.handleCloseFormModal()">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="row modal-body">
      <div class="mb-3 col-xxl-6 col-md-6">
        <label for="contactUsMessage" class="form-label">متن ارتباط با ما</label>
        <input type="input" class="form-control" id="contactUsMessage" formControlName="contactUsMessage" [ngClass]="{
            'is-invalid':
              form.contactUsMessage.touched && form.contactUsMessage.invalid
          }" />
        <div *ngIf="
            form.contactUsMessage.touched &&
            form.contactUsMessage.errors?.required
          " class="invalid-feedback">
          وارد کردن متن ارتباط با ما اجباریست
        </div>
      </div>
      <!--end col-->

      <div class="mb-3 col-xxl-6 col-md-6">
        <label for="poweredBy" class="form-label">حامی</label>
        <input type="input" class="form-control" id="poweredBy" formControlName="poweredBy" [ngClass]="{
            'is-invalid': form.poweredBy.touched && form.poweredBy.invalid
          }" />
        <div *ngIf="form.poweredBy.touched && form.poweredBy.errors?.required" class="invalid-feedback">
          وارد کردن حامی اجباریست
        </div>
      </div>
      <!--end col-->

      <div class="mb-3 col-xxl-6 col-md-6">
        <label for="callUs" class="form-label">تماس با ما</label>
        <input type="input" class="form-control" id="callUs" formControlName="callUs" [ngClass]="{
            'is-invalid': form.callUs.touched && form.callUs.invalid
          }" />
        <div *ngIf="form.callUs.touched && form.callUs.errors?.required" class="invalid-feedback">
          وارد کردن تماس با ما اجباریست
        </div>
      </div>
      <!--end col-->
      <div class="mb-3 col-xxl-6 col-md-6">
        <app-file-upload [title]="'لوگوی دسکتاپ'" [savedFileId]="form.desktopLogo.value" [isRequired]="true"
          [savedFileUrl]="selectedFileUrlDesktop"
          (uploadResponseEvent)="onFileSelectedDesktop($event)"></app-file-upload>
        <div class="mt-1 text-danger" *ngIf="form.desktopLogo.touched && form.desktopLogo.errors?.required">
          وارد کردن لوگوی دسکتاپ اجباریست
        </div>
      </div>
      <!--end col-->
      <div class="mb-3 col-xxl-6 col-md-6">
        <app-file-upload [title]="'لوگوی تلفن همراه'" [savedFileId]="form.mobileLogo.value"
          [savedFileUrl]="selectedFileUrlMobile" [isRequired]="true"
          (uploadResponseEvent)="onFileSelectedMobile($event)"></app-file-upload>
        <div class="mt-1 text-danger" *ngIf="form.mobileLogo.touched && form.mobileLogo.errors?.required">
          وارد کردن لوگوی موبایل اجباریست
        </div>
      </div>
      <!--end col-->
      <div class="mb-3 col-xxl-6 col-md-6">
        <app-file-upload [title]="'لوگوی فوتر'" [savedFileId]="form.footerLogo.value"
          [savedFileUrl]="selectedFileUrlFooter" [isRequired]="true"
          (uploadResponseEvent)="onFileSelectedFooter($event)"></app-file-upload>
        <div class="mt-1 text-danger" *ngIf="form.footerLogo.touched && form.footerLogo.errors?.required">
          وارد کردن لوگوی فوتر اجباریست
        </div>
      </div>
      <!--end col-->
      <div class="mb-3 col-xxl-6 col-md-6">
        <app-file-upload [title]="'پس زمینه اسلایدر'" [savedFileId]="form.sliderBackGroundImage.value"
          [savedFileUrl]="selectedFileUrlSliderBackGroundImage" [isRequired]="true"
          (uploadResponseEvent)="onFileSelectedSliderBackGroundImage($event)"></app-file-upload>
        <div class="mt-1 text-danger" *ngIf="
            form.sliderBackGroundImage.touched &&
            form.sliderBackGroundImage.errors?.required
          ">
          وارد کردن پس زمینه اسلایدر اجباریست
        </div>
      </div>
      <!--end col-->

      <div class="form-check form-switch mb-3 col-xxl-6 col-md-6 w-auto">
        <input class="form-check-input" type="checkbox" role="switch" id="isDefault" formControlName="isDefault"
          [ngClass]="{
            'is-invalid': form.isDefault.touched && form.isDefault.invalid
          }" />
        <label class="form-check-label" for="isDefault">پیش فرض</label>
      </div>
      <!--end col-->
    </div>
    <div class="modal-footer">
      <button type="button" (click)="modal.dismiss('Cross click'); this.handleCloseFormModal()" style="margin-left: 5px"
        class="btn btn-warning">
        انصراف
      </button>
      <button type="button" (click)="resetForm()" style="margin-left: 5px" class="btn btn-warning">
        پاک کردن فرم
      </button>
      <button class="btn btn-primary" [class.btn-loading]="inProgress" [disabled]="inProgress" type="submit">
        <ng-container *ngIf="!inProgress; else loadingTemplate">
          ذخیره
        </ng-container>
        <ng-template #loadingTemplate>
          <span class="visually-hidden">Loading...</span>
        </ng-template>
      </button>
    </div>
  </form>
</ng-template>

<ng-template #corporationInfoTabModel let-modal>
  <div class="modal-content">
    <div class="modal-header">
      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" id="btn-close"
        (click)="modal.dismiss('Cross click')"></button>
    </div>
    <div class="modal-body">
      <div class="card">
        <div class="card-header">
          <div>
            <ul ngbNav #customNav="ngbNav" [activeId]="1"
              class="nav nav-tabs-custom rounded card-header-tabs border-bottom-0" role="tablist">
              <li [ngbNavItem]="1" class="nav-item">
                <a ngbNavLink class="nav-link" data-bs-toggle="tab" role="tab">
                  آدرس ایمیل ها
                </a>
                <ng-template ngbNavContent>
                  <app-email-address [corporationInfo]="selectedItem"></app-email-address>
                </ng-template>
              </li>

              <li [ngbNavItem]="2" class="nav-item">
                <a ngbNavLink class="nav-link" data-bs-toggle="tab" role="tab">
                  آدرس ها
                </a>
                <ng-template ngbNavContent>
                  <app-location-address [corporationInfo]="selectedItem"></app-location-address>
                </ng-template>
              </li>

              <li [ngbNavItem]="3" class="nav-item">
                <a ngbNavLink class="nav-link" data-bs-toggle="tab" role="tab">
                  شماره تماس ها
                </a>
                <ng-template ngbNavContent>
                  <app-phone-number [corporationInfo]="selectedItem"></app-phone-number>
                </ng-template>
              </li>

              <li [ngbNavItem]="4" class="nav-item">
                <a ngbNavLink class="nav-link" data-bs-toggle="tab" role="tab">
                  ساعات کاری
                </a>
                <ng-template ngbNavContent>
                  <app-working-hour [corporationInfo]="selectedItem"></app-working-hour>
                </ng-template>
              </li>
            </ul>
          </div>
        </div>
        <div class="card-body">
          <div class="tab-content">
            <div [ngbNavOutlet]="customNav"></div>
          </div>
        </div>
      </div>
      <!--end card-->
    </div>
  </div>
  <!-- /.modal-content -->
</ng-template>