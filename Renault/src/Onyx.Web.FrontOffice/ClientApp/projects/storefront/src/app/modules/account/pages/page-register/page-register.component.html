<app-block-space layout="after-header"></app-block-space>

<div class="block">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-8 mt-4">
                <div class="card mb-0">
                    <div class="card-body card-body--padding--2">
                        <h3 class="card-title">{{ 'HEADER_REGISTER'|translate }}</h3>
                        <div class="form-group">
                            <label for="formPartSelect">انتخاب نوع مشتری:</label>
                            <select class="form-control" id="formPartSelect" [(ngModel)]="selectedFormPart">
                                <option value="natural">حقیقی</option>
                                <option value="legal">حقوقی</option>
                            </select>
                        </div>
                        <!-- natural -->
                        <div *ngIf="selectedFormPart === 'natural'">
                            <form [formGroup]="registerForm">
                                <div *ngIf="registerForm.errors && registerForm.errors['server']"
                                    class="alert alert-sm alert-danger">
                                    {{ ((registerForm.errors && registerForm.errors['server']) || '')|translate }}
                                </div>

                                <!-- First Line -->
                                <div class="form-group d-flex">
                                    <div class="mr-2 ml-5 flex-grow-1">
                                        <div class="form-label-group">
                                            <input id="signup-firstName" type="firstName" class="form-control"
                                                [class.is-invalid]="registerForm.controls['firstName']|isInvalid"
                                                [placeholder]="'INPUT_FIRSTNAME_PLACEHOLDER'|translate"
                                                formControlName="firstName">
                                            <label for="signup-firstName">{{ 'INPUT_FIRSTNAME_LABEL'|translate
                                                }}</label>

                                            <div class="invalid-feedback">
                                                <div *ngIf="registerForm.controls['firstName']|hasError:'required'">
                                                    {{ 'ERROR_FORM_REQUIRED'|translate }}
                                                </div>
                                                <div *ngIf="registerForm.controls['firstName']|hasError:'firstName'">
                                                    {{ 'ERROR_FORM_INCORRECT_FIRSTNAME'|translate }}
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="flex-grow-1">
                                        <div class="form-label-group">
                                            <input id="signup-lastName" type="lastName" class="form-control"
                                                [class.is-invalid]="registerForm.controls['lastName']|isInvalid"
                                                [placeholder]="'INPUT_LASTNAME_PLACEHOLDER'|translate"
                                                formControlName="lastName">
                                            <label for="signup-lastName">{{ 'INPUT_LASTNAME_LABEL'|translate }}</label>
                                            <div class="invalid-feedback">
                                                <div *ngIf="registerForm.controls['lastName']|hasError:'required'">
                                                    {{ 'ERROR_FORM_REQUIRED'|translate }}
                                                </div>
                                                <div *ngIf="registerForm.controls['lastName']|hasError:'lastName'">
                                                    {{ 'ERROR_FORM_INCORRECT_LASTNAME'|translate }}
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                </div>

                                <!-- Second Line -->
                                <div class="form-group d-flex">
                                    <div class="mr-2 ml-5 flex-grow-1">
                                        <div class="form-label-group">
                                            <input id="signup-userName" type="userName" class="form-control"
                                                [class.is-invalid]="registerForm.controls['userName']|isInvalid"
                                                [placeholder]="'INPUT_USERNAME_PLACEHOLDER'|translate"
                                                formControlName="userName" style="text-align: left; direction: ltr;">
                                            <label for="signup-userName">{{ 'INPUT_USERNAME_LABEL'|translate }}</label>
                                            <div class="invalid-feedback">
                                                <div *ngIf="registerForm.controls['userName']|hasError:'required'">
                                                    {{ 'ERROR_FORM_REQUIRED'|translate }}
                                                </div>
                                                <div *ngIf="registerForm.controls['userName']|hasError:'pattern'">
                                                    {{ 'ERROR_FORM_INCORRECT_USERNAME'|translate }}
                                                </div>
                                                <div
                                                *ngIf="
                                                  registerForm.controls['userName'].touched &&
                                                  registerForm.controls['userName'].errors?.['userNameTaken']
                                                ">
                                                نام کاربری تکراری است
                                              </div>
                                              <div *ngIf="registerForm.controls['userName'].touched && registerForm.controls['userName'].pending">
                                                یگانگی نام کاربری در حال بررسی است
                                              </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="flex-grow-1">
                                        <div class="form-label-group">
                                            <input id="signup-nationalCode" type="nationalCode" class="form-control"
                                                [class.is-invalid]="registerForm.controls['nationalCode']|isInvalid"
                                                [placeholder]="'INPUT_NATIONALCODE_PLACEHOLDER'|translate"
                                                formControlName="nationalCode"
                                                style="text-align: left; direction: ltr;">
                                            <label for="signup-nationalCode">{{ 'INPUT_NATIONALCODE_LABEL'|translate
                                                }}</label>
                                            <div class="invalid-feedback">
                                                <div *ngIf="registerForm.controls['nationalCode']|hasError:'required'">
                                                    {{ 'ERROR_FORM_REQUIRED'|translate }}
                                                </div>
                                                <div *ngIf="registerForm.controls['nationalCode']|hasError:'pattern'">
                                                    {{ 'ERROR_FORM_INCORRECT_NATIONALCODE'|translate }}
                                                </div>
                                                <div *ngIf="
                                                    registerForm.controls['nationalCode'].errors?.['nationalCodeTaken']">
                                                    کد ملی تکراری است
                                                </div>
                                                <div
                                                    *ngIf="registerForm.controls['nationalCode'].pending">
                                                    یگانگی کد ملی در حال بررسی است
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                </div>

                                <!-- Third Line -->
                                <div class="form-group d-flex">
                                    <div class="mr-2 ml-5 flex-grow-1">
                                        <div class="form-label-group">
                                            <input id="signup-phoneNumber" type="phoneNumber" class="form-control"
                                                [class.is-invalid]="registerForm.controls['phoneNumber']|isInvalid"
                                                [placeholder]="'INPUT_PHONE_NUMBER_PLACEHOLDER'|translate"
                                                formControlName="phoneNumber" style="text-align: left; direction: ltr;">
                                            <label for="signup-phoneNumber">{{ 'INPUT_PHONE_NUMBER_LABEL'|translate
                                                }}</label>
                                            <div class="invalid-feedback">
                                                <div *ngIf="registerForm.controls['phoneNumber']|hasError:'required'">
                                                    {{ 'ERROR_FORM_REQUIRED'|translate }}
                                                </div>
                                                <div *ngIf="registerForm.controls['phoneNumber']|hasError:'minlength'">
                                                    {{ 'ERROR_FORM_INCORRECT_PHONE_NUMBER_LENGTH'|translate }}
                                                </div>
                                                <div *ngIf="registerForm.controls['phoneNumber']|hasError:'maxlength'">
                                                    {{ 'ERROR_FORM_INCORRECT_PHONE_NUMBER_LENGTH'|translate }}
                                                </div>
                                                <div *ngIf="registerForm.controls['phoneNumber']|hasError:'pattern'">
                                                    {{ 'ERROR_FORM_INCORRECT_PHONE_NUMBER_PATTERN'|translate }}
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="flex-grow-1">
                                        <div class="form-label-group">
                                            <input id="signup-email" type="email" class="form-control"
                                                [class.is-invalid]="registerForm.controls['email']|isInvalid"
                                                [placeholder]="'INPUT_EMAIL_PLACEHOLDER'|translate"
                                                formControlName="email" style="text-align: left; direction: ltr;">
                                            <label for="signup-email">{{ 'INPUT_EMAIL_LABEL'|translate }}</label>
                                            <div class="invalid-feedback">
                                                <div *ngIf="registerForm.controls['email']|hasError:'required'">
                                                    {{ 'ERROR_FORM_REQUIRED'|translate }}
                                                </div>
                                                <div *ngIf="registerForm.controls['email']|hasError:'email'">
                                                    {{ 'ERROR_FORM_INCORRECT_EMAIL'|translate }}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- Fifth Line -->
                                <div class="form-group d-flex">
                                    <div class="mr-2 ml-5 flex-grow-1">
                                        <div class="form-label-group">
                                            <input id="signup-password" [type]="showPassword ? 'text' : 'password'"
                                                class="form-control"
                                                [class.is-invalid]="registerForm.controls['password']|isInvalid"
                                                [placeholder]="'INPUT_PASSWORD_PLACEHOLDER'|translate"
                                                formControlName="password">
                                            <label for="signup-password">{{ 'INPUT_PASSWORD_LABEL'|translate }}</label>
                                            <span type="button" (click)="togglePasswordVisibility()"
                                                class="d-flex align-items-center px-2 position-absolute">
                                                <i class="fas text-secondary"
                                                    [ngClass]="{'fa-eye': showPassword, 'fa-eye-slash': !showPassword}"></i>
                                            </span>
                                            <div class="invalid-feedback">
                                                <div *ngIf="registerForm.controls['password']|hasError:'required'">
                                                    {{ 'ERROR_FORM_REQUIRED'|translate }}
                                                </div>
                                                <div *ngIf="registerForm.controls['password'].hasError('minlength')">
                                                    {{ 'ERROR_API_AUTH_WEAK_PASSWORD'|translate }}
                                                </div>
                                                <div *ngIf="registerForm.controls['password'].hasError('missingDigit')">
                                                    {{ 'ERROR_API_AUTH_PASSWORD_MISSINGDIGIT'|translate }}
                                                </div>
                                                <div
                                                    *ngIf="registerForm.controls['password'].hasError('missingLowercase')">
                                                    {{"ERROR_API_AUTH_PASSWORD_REQUIRES_LOWER" | translate }}
                                                </div>
                                                <div
                                                    *ngIf="registerForm.controls['password'].hasError('missingUppercase')">
                                                    {{"ERROR_API_AUTH_PASSWORD_REQUIRES_UPPER" | translate }}
                                                </div>
                                                <div
                                                    *ngIf="registerForm.controls['password'].hasError('notEnoughUniqueChars')">
                                                    {{"ERROR_API_AUTH_PASSWORD_REQUIRES_UNIQUECHARS" | translate }}
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="flex-grow-1">

                                        <div class="form-label-group">
                                            <input id="signup-confirm"
                                                [type]="showConfirmPassword ? 'text' : 'password'" class="form-control"
                                                [class.is-invalid]="registerForm.controls['confirmPassword']|isInvalid"
                                                [placeholder]="'INPUT_PASSWORD_REPEAT_PLACEHOLDER'|translate"
                                                formControlName="confirmPassword">
                                            <label for="signup-confirm">{{ 'INPUT_PASSWORD_REPEAT_LABEL'|translate
                                                }}</label>

                                            <span type="button" class="d-flex align-items-center px-2 position-absolute"
                                                (click)="toggleConfirmPasswordVisibility()">
                                                <i class="fas text-secondary"
                                                    [ngClass]="{'fa-eye': showConfirmPassword, 'fa-eye-slash': !showConfirmPassword}"></i>
                                            </span>

                                            <div class="invalid-feedback">
                                                <div
                                                    *ngIf="registerForm.controls['confirmPassword']|hasError:'required'">
                                                    {{ 'ERROR_FORM_REQUIRED'|translate }}
                                                </div>
                                                <div
                                                    *ngIf="registerForm.controls['confirmPassword']|hasError:'mustMatch'">
                                                    {{ 'ERROR_FORM_PASSWORD_DOES_NOT_MATCH'|translate }}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>


                                <div class="flex-grow-1 form-group d-flex">
                                    <app-captcha (changeValue)="setCaptcha($event)" [form]="registerForm"
                                        (formConfirm)="register()"></app-captcha>
                                </div>

                                <!-- Submit Button -->
                                <div class="form-group mb-0">
                                    <button type="submit" class="btn btn-primary mt-3"
                                        [class.btn-loading]="registerInProgress" (click)="register()">
                                        {{ 'BUTTON_REGISTER'|translate }}
                                    </button>
                                </div>
                            </form>
                        </div>

                        <div *ngIf="selectedFormPart === 'legal'">
                            <!-- legal -->
                            <form [formGroup]="registerForm">
                                <div *ngIf="registerForm.errors && registerForm.errors['server']"
                                    class="alert alert-sm alert-danger">
                                    {{ ((registerForm.errors && registerForm.errors['server']) || '')|translate }}
                                </div>

                                <!-- First Line -->
                                <div class="form-group d-flex">
                                    <div class="mr-2 ml-5 flex-grow-1">
                                        <div class="form-label-group">

                                            <input id="signup-firstName" type="firstName" class="form-control"
                                                [class.is-invalid]="registerForm.controls['firstName']|isInvalid"
                                                [placeholder]="'INPUT_COMPANYNAME_PLACEHOLDER'|translate"
                                                formControlName="firstName">
                                            <label for="signup-firstName">{{ 'INPUT_COMPANYNAME_LABEL'|translate
                                                }}</label>
                                            <div class="invalid-feedback">
                                                <div *ngIf="registerForm.controls['firstName']|hasError:'required'">
                                                    {{ 'ERROR_FORM_REQUIRED'|translate }}
                                                </div>
                                                <div *ngIf="registerForm.controls['firstName']|hasError:'firstName'">
                                                    {{ 'ERROR_FORM_INCORRECT_FIRSTNAME'|translate }}
                                                </div>
                                            </div>
                                        </div>

                                    </div>

                                    <div class="flex-grow-1">
                                        <div class="form-label-group">
                                            <input id="signup-lastName" type="lastName" class="form-control"
                                                [class.is-invalid]="registerForm.controls['lastName']|isInvalid"
                                                [placeholder]="'INPUT_ECONOMICCODE_PLACEHOLDER'|translate"
                                                formControlName="lastName">
                                            <label for="signup-lastName">{{ 'INPUT_ECONOMICCODE_LABEL'|translate
                                                }}</label>
                                            <div class="invalid-feedback">
                                                <div *ngIf="registerForm.controls['lastName']|hasError:'required'">
                                                    {{ 'ERROR_FORM_REQUIRED'|translate }}
                                                </div>
                                                <div *ngIf="registerForm.controls['lastName']|hasError:'lastName'">
                                                    {{ 'ERROR_FORM_INCORRECT_LASTNAME'|translate }}
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                </div>

                                <!-- Second Line -->
                                <div class="form-group d-flex">
                                    <div class="mr-2 ml-5 flex-grow-1">
                                        <div class="form-label-group">

                                            <input id="signup-userName" type="userName" class="form-control"
                                                [class.is-invalid]="registerForm.controls['userName']|isInvalid"
                                                [placeholder]="'INPUT_USERNAME_PLACEHOLDER'|translate"
                                                formControlName="userName" style="text-align: left; direction: ltr;">
                                            <label for="signup-userName">{{ 'INPUT_USERNAME_LABEL'|translate }}</label>
                                            <div class="invalid-feedback">
                                                <div *ngIf="registerForm.controls['userName']|hasError:'required'">
                                                    {{ 'ERROR_FORM_REQUIRED'|translate }}
                                                </div>
                                                <div *ngIf="registerForm.controls['userName']|hasError:'userName'">
                                                    {{ 'ERROR_FORM_INCORRECT_USERNAME'|translate }}
                                                </div>
                                                <div
                                                *ngIf="
                                                  registerForm.controls['userName'].touched &&
                                                  registerForm.controls['userName'].errors?.['userNameTaken']
                                                ">
                                                نام کاربری تکراری است
                                              </div>
                                              <div *ngIf="registerForm.controls['userName'].touched && registerForm.controls['userName'].pending">
                                                یگانگی نام کاربری در حال بررسی است
                                              </div>
                                            </div>
                                        </div>

                                    </div>

                                    <div class="flex-grow-1">
                                        <div class="form-label-group">
                                            <input id="signup-nationalCode" type="nationalCode" class="form-control"
                                                [class.is-invalid]="registerForm.controls['nationalCode']|isInvalid"
                                                [placeholder]="'INPUT_NATIONALID_PLACEHOLDER'|translate"
                                                formControlName="nationalCode"
                                                style="text-align: left; direction: ltr;">
                                            <label for="signup-nationalCode">{{ 'INPUT_NATIONALID_LABEL'|translate
                                                }}</label>
                                            <div class="invalid-feedback">
                                                <div *ngIf="registerForm.controls['nationalCode']|hasError:'required'">
                                                    {{ 'ERROR_FORM_REQUIRED'|translate }}
                                                </div>
                                                <div
                                                    *ngIf="registerForm.controls['nationalCode']|hasError:'nationalCode'">
                                                    {{ 'ERROR_FORM_INCORRECT_NATIONALCODE'|translate }}
                                                </div>
                                                <div *ngIf="
                                                    registerForm.controls['nationalCode'].touched &&
                                                    registerForm.controls['nationalCode'].errors?.['nationalCodeTaken']">
                                                    کد ملی/شناسه ملی تکراری است
                                                </div>
                                                <div
                                                    *ngIf="
                                                     registerForm.controls['nationalCode'].touched &&
                                                     registerForm.controls['nationalCode'].pending">
                                                    یگانگی کد ملی/شناسه ملی در حال بررسی است
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                </div>

                                <!-- Third Line -->
                                <div class="form-group d-flex">
                                    <div class="mr-2 ml-5 flex-grow-1">
                                        <div class="form-label-group">

                                            <input id="signup-phoneNumber" type="phoneNumber" class="form-control"
                                                [class.is-invalid]="registerForm.controls['phoneNumber']|isInvalid"
                                                [placeholder]="'INPUT_PHONE_NUMBER_PLACEHOLDER'|translate"
                                                formControlName="phoneNumber" style="text-align: left; direction: ltr;">
                                            <label for="signup-phoneNumber">{{ 'INPUT_PHONE_NUMBER_LABEL'|translate
                                                }}</label>
                                            <div class="invalid-feedback">
                                                <div *ngIf="registerForm.controls['phoneNumber']|hasError:'required'">
                                                    {{ 'ERROR_FORM_REQUIRED'|translate }}
                                                </div>
                                                <div *ngIf="registerForm.controls['phoneNumber']|hasError:'minlength'">
                                                    {{ 'ERROR_FORM_INCORRECT_PHONE_NUMBER_LENGTH'|translate }}
                                                </div>
                                                <div *ngIf="registerForm.controls['phoneNumber']|hasError:'maxlength'">
                                                    {{ 'ERROR_FORM_INCORRECT_PHONE_NUMBER_LENGTH'|translate }}
                                                </div>
                                                <div *ngIf="registerForm.controls['phoneNumber']|hasError:'pattern'">
                                                    {{ 'ERROR_FORM_INCORRECT_PHONE_NUMBER_PATTERN'|translate }}
                                                </div>
                                            </div>
                                        </div>

                                    </div>

                                    <div class="flex-grow-1">
                                        <div class="form-label-group">

                                            <input id="signup-email" type="email" class="form-control"
                                                [class.is-invalid]="registerForm.controls['email']|isInvalid"
                                                [placeholder]="'INPUT_LEGALEMAIL_PLACEHOLDER'|translate"
                                                formControlName="email" style="text-align: left; direction: ltr;">
                                            <label for="signup-email">{{ 'INPUT_LEGALEMAIL_LABEL'|translate }}</label>
                                            <div class="invalid-feedback">
                                                <div *ngIf="registerForm.controls['email']|hasError:'required'">
                                                    {{ 'ERROR_FORM_REQUIRED'|translate }}
                                                </div>
                                                <div *ngIf="registerForm.controls['email']|hasError:'email'">
                                                    {{ 'ERROR_FORM_INCORRECT_EMAIL'|translate }}
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                </div>

                                <!-- Fifth Line -->
                                <div class="form-group d-flex">
                                    <div class="mr-2 ml-5 flex-grow-1">
                                        <div class="form-label-group">
                                            <input id="signup-password" [type]="showPassword ? 'text' : 'password'"
                                                class="form-control"
                                                [class.is-invalid]="registerForm.controls['password']|isInvalid"
                                                [placeholder]="'INPUT_PASSWORD_PLACEHOLDER'|translate"
                                                formControlName="password">
                                            <label for="signup-password">{{ 'INPUT_PASSWORD_LABEL'|translate }}</label>

                                            <span class="d-flex align-items-center px-2 position-absolute" type="button"
                                                (click)="togglePasswordVisibility()">
                                                <i class="fas text-secondary"
                                                    [ngClass]="{'fa-eye': showPassword, 'fa-eye-slash': !showPassword}"></i>
                                            </span>

                                            <div class="invalid-feedback">
                                                <div *ngIf="registerForm.controls['password']|hasError:'required'">
                                                    {{ 'ERROR_FORM_REQUIRED'|translate }}
                                                </div>
                                            </div>

                                        </div>

                                    </div>

                                    <div class="flex-grow-1">
                                        <div class="form-label-group">
                                            <div class="form-label-group">
                                                <input id="signup-confirm"
                                                    [type]="showConfirmPassword ? 'text' : 'password'"
                                                    class="form-control"
                                                    [class.is-invalid]="registerForm.controls['confirmPassword']|isInvalid"
                                                    [placeholder]="'INPUT_PASSWORD_REPEAT_PLACEHOLDER'|translate"
                                                    formControlName="confirmPassword">
                                                <label for="signup-confirm">{{
                                                    'INPUT_PASSWORD_REPEAT_LABEL'|translate}}</label>
                                                <span class="d-flex align-items-center px-2 position-absolute"
                                                    type="button" (click)="toggleConfirmPasswordVisibility()">
                                                    <i class="fas text-secondary"
                                                        [ngClass]="{'fa-eye': showConfirmPassword, 'fa-eye-slash': !showConfirmPassword}"></i>
                                                </span>

                                                <div class="invalid-feedback">
                                                    <div
                                                        *ngIf="registerForm.controls['confirmPassword']|hasError:'required'">
                                                        {{ 'ERROR_FORM_REQUIRED'|translate }}
                                                    </div>
                                                    <div
                                                        *ngIf="registerForm.controls['confirmPassword']|hasError:'mustMatch'">
                                                        {{ 'ERROR_FORM_PASSWORD_DOES_NOT_MATCH'|translate }}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                </div>


                                <div class="flex-grow-1 form-group d-flex">
                                    <app-captcha (changeValue)="setCaptcha($event)" [form]="registerForm"
                                        (formConfirm)="register()"></app-captcha>
                                </div>

                                <!-- Submit Button -->
                                <div class="form-group mb-0">
                                    <button type="submit" class="btn btn-primary mt-3"
                                        [class.btn-loading]="registerInProgress" (click)="register()">
                                        {{ 'BUTTON_REGISTER'|translate }}
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<app-block-space layout="before-footer"></app-block-space>